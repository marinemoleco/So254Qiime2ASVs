## Step 2 - qiime2 ##

# start qiime2
source activate qiime2-2018.6

# import sequence fastq data
# https://docs.qiime2.org/2018.8/tutorials/importing/
qiime tools import \
 --type 'SampleData[PairedEndSequencesWithQuality]' \
 --input-path pe-33-manifest \
 --output-path bbduk-paired-end-demux.qza \
 --source-format PairedEndFastqManifestPhred33

# DADA2 denoising -> create dada2 based ASVs
# https://docs.qiime2.org/2018.6/tutorials/atacama-soils/
# https://forum.qiime2.org/t/dada2-truncation-lengths-and-features-number/1940/9
qiime dada2 denoise-paired \
 --i-demultiplexed-seqs bbduk-paired-end-demux.qza \
 --p-trim-left-f 13 \
 --p-trim-left-r 13 \
 --p-trunc-len-f 280 \
 --p-trunc-len-r 220 \
 --p-n-threads 0 \
 --o-table table.qza \
 --o-representative-sequences rep-seqs.qza \
 --o-denoising-stats denoising-stats.qza
